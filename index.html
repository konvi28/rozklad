<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/webp" href="logo.webp">
    <link rel="shortcut icon" type="image/webp" href="logo.webp">
    <link rel="apple-touch-icon" href="logo.webp">
    <title>–†–æ–∑–∫–ª–∞–¥ —É—Ä–æ–∫—ñ–≤ 1.92</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s;
            border: none;
            background: none;
            font-size: 16px;
        }

        .tab:hover {
            background: #e9ecef;
        }

        .tab.active {
            color: #667eea;
            background: white;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
            padding: 8px 16px;
            font-size: 14px;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .class-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .class-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
        }

        .class-card h3 {
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        .class-card-actions {
            margin-top: 15px;
        }

        .subject-list {
            margin-top: 30px;
        }

        .subject-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 2px solid #e9ecef;
        }

        .subject-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .subject-info {
            flex: 1;
        }

        .subject-name {
            font-weight: 600;
            color: #333;
            font-size: 18px;
        }

        .subject-teacher {
            color: #6c757d;
            font-size: 14px;
            margin-top: 5px;
        }

        .subject-hours {
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            margin-right: 10px;
        }

        .tiles-container {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 10px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            min-height: 50px;
        }

        .tiles-container.drag-over {
            background: #e7f3ff;
            border: 2px dashed #667eea;
        }

        .lesson-tile {
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: move;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s;
            font-size: 12px;
            font-weight: 600;
            user-select: none;
        }

        .lesson-tile:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .lesson-tile.dragging {
            opacity: 0.5;
        }

        .lesson-tile.used {
            background: #6c757d !important;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .schedule-wrapper {
            overflow: auto;
            margin-top: 20px;
            max-height: 600px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            background: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .schedule-wrapper::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        .schedule-wrapper::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .schedule-wrapper::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }
        
        .schedule-wrapper::-webkit-scrollbar-thumb:hover {
            background: #5568d3;
        }

        .schedule-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
            background: white;
        }

        .schedule-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            border: 1px solid rgba(255,255,255,0.2);
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .schedule-table th:first-child,
        .schedule-table th:nth-child(2) {
            position: sticky;
            left: 0;
            z-index: 11;
        }
        
        .schedule-table th:nth-child(2) {
            left: auto;
        }

        .schedule-table td {
            padding: 10px;
            border: 1px solid #e9ecef;
            text-align: center;
            vertical-align: middle;
            min-height: 80px;
        }
        
        .schedule-table td:first-child {
            position: sticky;
            left: 0;
            background: #e9ecef;
            z-index: 5;
            font-weight: 600;
        }
        
        .schedule-table td.lesson-number {
            position: sticky;
            left: 0;
            z-index: 5;
        }

        .lesson-number {
            font-weight: 600;
            background: #f8f9fa;
            color: #667eea;
        }

        .lesson-slot {
            min-height: 60px;
            background: #f8f9fa;
            border: 2px dashed #e9ecef;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #adb5bd;
            font-size: 12px;
            transition: all 0.3s;
        }

        .lesson-slot:hover {
            background: #e9ecef;
            border-color: #667eea;
        }

        .lesson-slot.drag-over {
            background: #e7f3ff;
            border-color: #667eea;
            border-style: solid;
        }

        .lesson-card {
            padding: 10px;
            border-radius: 8px;
            color: white;
            cursor: move;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
            user-select: none;
        }

        .lesson-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .lesson-card.dragging {
            opacity: 0.5;
        }

        .lesson-card-subject {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .lesson-card-teacher {
            font-size: 12px;
            opacity: 0.9;
        }

        .available-tiles-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .available-tiles-section h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .schedules-container {
            margin-top: 20px;
        }

        .class-schedule-section {
            margin-bottom: 30px;
        }

        .class-schedule-title {
            font-size: 24px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #495057;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö –†–æ–∑–∫–ª–∞–¥ —É—Ä–æ–∫—ñ–≤</h1>
            <p>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥–æ–º –¥–ª—è —à–∫–æ–ª–∏</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('classes')">–ö–ª–∞—Å–∏</button>
            <button class="tab" onclick="switchTab('subjects')">–ü—Ä–µ–¥–º–µ—Ç–∏ —ñ –≤—á–∏—Ç–µ–ª—ñ</button>
            <button class="tab" onclick="switchTab('schedule')">–†–æ–∑–∫–ª–∞–¥</button>
        </div>

        <div id="classesTab" class="tab-content active">
            <h2>–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π –∫–ª–∞—Å</h2>
            <div class="form-group">
                <label for="className">–ù–∞–∑–≤–∞ –∫–ª–∞—Å—É:</label>
                <input type="text" id="className" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: 5-–ê">
            </div>
            <button class="btn btn-primary" onclick="addClass()">–î–æ–¥–∞—Ç–∏ –∫–ª–∞—Å</button>
            
            <h2 style="margin-top: 40px;">–°–ø–∏—Å–æ–∫ –∫–ª–∞—Å—ñ–≤</h2>
            <div id="classList" class="class-list"></div>
        </div>

        <div id="subjectsTab" class="tab-content">
            <h2>–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π –ø—Ä–µ–¥–º–µ—Ç</h2>
            <div class="form-group">
                <label for="subjectName">–ù–∞–∑–≤–∞ –ø—Ä–µ–¥–º–µ—Ç—É:</label>
                <input type="text" id="subjectName" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞">
            </div>
            <div class="form-group">
                <label for="teacherName">–Ü–º'—è –≤—á–∏—Ç–µ–ª—è:</label>
                <input type="text" id="teacherName" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω–æ–≤ –Ü.–Ü.">
            </div>
            <div class="form-group">
                <label for="hoursPerWeek">–ö—ñ–ª—å–∫—ñ—Å—Ç—å –≥–æ–¥–∏–Ω –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å:</label>
                <input type="number" id="hoursPerWeek" min="1" max="20" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: 5">
            </div>
            <button class="btn btn-primary" onclick="addSubject()">–î–æ–¥–∞—Ç–∏ –ø—Ä–µ–¥–º–µ—Ç</button>
            
            <div id="subjectList" class="subject-list"></div>
        </div>

        <div id="scheduleTab" class="tab-content">
            <div id="scheduleContent"></div>
        </div>
    </div>

    <script>
        const days = ['–ü–æ–Ω–µ–¥—ñ–ª–æ–∫', '–í—ñ–≤—Ç–æ—Ä–æ–∫', '–°–µ—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä', '–ü\'—è—Ç–Ω–∏—Ü—è'];
        const lessons = 7;
        
        let classes = [];
        let subjects = [];
        let schedules = {};
        let nextClassId = 1;
        let nextSubjectId = 1;

        const subjectColors = [
            '#667eea', '#f093fb', '#4facfe', '#43e97b',
            '#fa709a', '#fee140', '#30cfd0', '#a8edea',
            '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4'
        ];

        function getSubjectColor(subjectId) {
            return subjectColors[(subjectId - 1) % subjectColors.length];
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        function addClass() {
            const name = document.getElementById('className').value.trim();
            
            if (!name) {
                alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –∫–ª–∞—Å—É');
                return;
            }

            const newClass = {
                id: nextClassId++,
                name: name
            };

            classes.push(newClass);
            schedules[newClass.id] = {};
            
            document.getElementById('className').value = '';
            renderClasses();
            renderSchedules();
        }

        function removeClass(id) {
            if (confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π –∫–ª–∞—Å?')) {
                classes = classes.filter(c => c.id !== id);
                delete schedules[id];
                renderClasses();
                renderSchedules();
            }
        }

        function addSubject() {
            const name = document.getElementById('subjectName').value.trim();
            const teacher = document.getElementById('teacherName').value.trim();
            const hours = parseInt(document.getElementById('hoursPerWeek').value);

            if (!name || !teacher || !hours) {
                alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è');
                return;
            }

            const newSubject = {
                id: nextSubjectId++,
                name: name,
                teacher: teacher,
                hours: hours
            };

            subjects.push(newSubject);
            
            document.getElementById('subjectName').value = '';
            document.getElementById('teacherName').value = '';
            document.getElementById('hoursPerWeek').value = '';
            
            renderSubjects();
            renderSchedules();
        }

        function removeSubject(id) {
            if (confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π –ø—Ä–µ–¥–º–µ—Ç?')) {
                subjects = subjects.filter(s => s.id !== id);
                
                Object.keys(schedules).forEach(classId => {
                    Object.keys(schedules[classId]).forEach(key => {
                        if (schedules[classId][key].subjectId === id) {
                            delete schedules[classId][key];
                        }
                    });
                });
                
                renderSubjects();
                renderSchedules();
            }
        }

        function renderClasses() {
            const list = document.getElementById('classList');
            
            if (classes.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #6c757d; margin-top: 20px;">–ù–µ–º–∞—î –¥–æ–¥–∞–Ω–∏—Ö –∫–ª–∞—Å—ñ–≤</p>';
                return;
            }

            list.innerHTML = classes.map(cls => `
                <div class="class-card">
                    <h3>${cls.name}</h3>
                    <div class="class-card-actions">
                        <button class="btn btn-danger" onclick="removeClass(${cls.id})">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                    </div>
                </div>
            `).join('');
        }

        function renderSubjects() {
            const list = document.getElementById('subjectList');
            
            if (subjects.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #6c757d; margin-top: 20px;">–ù–µ–º–∞—î –¥–æ–¥–∞–Ω–∏—Ö –ø—Ä–µ–¥–º–µ—Ç—ñ–≤</p>';
                return;
            }

            list.innerHTML = subjects.map(subject => {
                let usedCount = 0;
                classes.forEach(cls => {
                    const schedule = schedules[cls.id] || {};
                    usedCount += Object.values(schedule).filter(s => s && s.subjectId === subject.id).length;
                });

                const color = getSubjectColor(subject.id);
                const tiles = [];
                
                for (let i = 0; i < subject.hours; i++) {
                    const isUsed = i < usedCount;
                    tiles.push(`
                        <div class="lesson-tile ${isUsed ? 'used' : ''}" 
                             draggable="${!isUsed}"
                             data-subject-id="${subject.id}"
                             data-tile-index="${i}"
                             style="background: ${color};">
                            ${subject.name}
                        </div>
                    `);
                }
                
                return `
                    <div class="subject-item">
                        <div class="subject-header">
                            <div class="subject-info">
                                <div class="subject-name">${subject.name}</div>
                                <div class="subject-teacher">–í—á–∏—Ç–µ–ª—å: ${subject.teacher}</div>
                            </div>
                            <span class="subject-hours">${usedCount}/${subject.hours} –≥–æ–¥</span>
                            <button class="btn btn-danger" onclick="removeSubject(${subject.id})">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                        </div>
                        <div class="tiles-container" 
                             data-subject-id="${subject.id}">
                            ${tiles.join('')}
                        </div>
                    </div>
                `;
            }).join('');

            // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø—ñ—Å–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É
            attachTileDragHandlers();
        }

        function renderSchedules() {
            const content = document.getElementById('scheduleContent');
            
            if (classes.length === 0) {
                content.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚ö†Ô∏è</div>
                        <h3>–°–ø–æ—á–∞—Ç–∫—É –¥–æ–¥–∞–π—Ç–µ –∫–ª–∞—Å–∏</h3>
                        <p>–ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ö–ª–∞—Å–∏" —Ç–∞ –¥–æ–¥–∞–π—Ç–µ –∫–ª–∞—Å–∏</p>
                    </div>
                `;
                return;
            }

            if (subjects.length === 0) {
                content.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚ö†Ô∏è</div>
                        <h3>–°–ø–æ—á–∞—Ç–∫—É –¥–æ–¥–∞–π—Ç–µ –ø—Ä–µ–¥–º–µ—Ç–∏</h3>
                        <p>–ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ü—Ä–µ–¥–º–µ—Ç–∏ —ñ –≤—á–∏—Ç–µ–ª—ñ" —Ç–∞ –¥–æ–¥–∞–π—Ç–µ –ø—Ä–µ–¥–º–µ—Ç–∏</p>
                    </div>
                `;
                return;
            }

            // –ì–µ–Ω–µ—Ä—É—î–º–æ –¥–æ—Å—Ç—É–ø–Ω—ñ –ø–ª–∏—Ç–æ—á–∫–∏
            let tilesHtml = '<div class="available-tiles-section"><h2>–î–æ—Å—Ç—É–ø–Ω—ñ —É—Ä–æ–∫–∏ –¥–ª—è —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è</h2>';
            
            subjects.forEach(subject => {
                let usedCount = 0;
                classes.forEach(cls => {
                    const schedule = schedules[cls.id] || {};
                    usedCount += Object.values(schedule).filter(s => s && s.subjectId === subject.id).length;
                });
                
                const availableCount = subject.hours - usedCount;
                
                if (availableCount > 0) {
                    const color = getSubjectColor(subject.id);
                    tilesHtml += `
                        <div class="subject-item" style="margin-bottom: 15px;">
                            <div class="subject-header">
                                <div class="subject-info">
                                    <div class="subject-name">${subject.name}</div>
                                    <div class="subject-teacher">–í—á–∏—Ç–µ–ª—å: ${subject.teacher} ‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–æ: ${availableCount} –∑ ${subject.hours}</div>
                                </div>
                            </div>
                            <div class="tiles-container" data-subject-id="${subject.id}">
                    `;
                    
                    for (let i = 0; i < availableCount; i++) {
                        tilesHtml += `
                            <div class="lesson-tile" 
                                 draggable="true"
                                 data-subject-id="${subject.id}"
                                 style="background: ${color};">
                                ${subject.name}
                            </div>
                        `;
                    }
                    
                    tilesHtml += '</div></div>';
                }
            });
            
            tilesHtml += '</div>';

            // –ì–µ–Ω–µ—Ä—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥
            let schedulesHtml = '<div class="schedules-container">';
            
            schedulesHtml += `
                <div class="class-schedule-section">
                    <div class="class-schedule-title">–†–æ–∑–∫–ª–∞–¥ —É—Ä–æ–∫—ñ–≤</div>
                    <div class="schedule-wrapper">
                        <table class="schedule-table">
                            <thead>
                                <tr>
                                    <th>–î–µ–Ω—å</th>
                                    <th>–£—Ä–æ–∫</th>
                                    ${classes.map(cls => `<th>${cls.name}</th>`).join('')}
                                </tr>
                            </thead>
                            <tbody>
            `;

            days.forEach((day, dayIndex) => {
                for (let i = 1; i <= lessons; i++) {
                    schedulesHtml += `<tr>`;
                    
                    if (i === 1) {
                        schedulesHtml += `<td rowspan="${lessons}" style="font-weight: 600; background: #e9ecef; vertical-align: middle;">${day}</td>`;
                    }
                    
                    schedulesHtml += `<td class="lesson-number">${i}</td>`;
                    
                    classes.forEach(cls => {
                        const key = `${dayIndex}-${i-1}`;
                        const lesson = schedules[cls.id][key];
                        
                        schedulesHtml += `<td>`;
                        
                        if (lesson) {
                            const color = getSubjectColor(lesson.subjectId);
                            schedulesHtml += `
                                <div class="lesson-card" draggable="true" 
                                     data-subject-id="${lesson.subjectId}"
                                     data-from-schedule="true"
                                     data-class-id="${cls.id}"
                                     data-day="${dayIndex}"
                                     data-lesson="${i-1}"
                                     style="background: ${color};">
                                    <div class="lesson-card-subject">${lesson.name}</div>
                                    <div class="lesson-card-teacher">${lesson.teacher}</div>
                                </div>
                            `;
                        } else {
                            schedulesHtml += `
                                <div class="lesson-slot" 
                                     data-class-id="${cls.id}"
                                     data-day="${dayIndex}" 
                                     data-lesson="${i-1}">
                                </div>
                            `;
                        }
                        
                        schedulesHtml += `</td>`;
                    });
                    
                    schedulesHtml += '</tr>';
                }
            });

            schedulesHtml += `
                            </tbody>
                        </table>
                    </div>
                </div>
            `;

            schedulesHtml += '</div>';
            content.innerHTML = tilesHtml + schedulesHtml;
            
            // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏
            attachScheduleDragHandlers();
        }

        let draggedElement = null;
        let draggedSubjectId = null;
        let fromSchedule = false;
        let originalSlot = null;

        function attachTileDragHandlers() {
            const tiles = document.querySelectorAll('.lesson-tile[draggable="true"]');
            tiles.forEach(tile => {
                tile.addEventListener('dragstart', handleTileDragStart);
                tile.addEventListener('dragend', handleDragEnd);
            });

            // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ –ø–ª–∏—Ç–æ–∫
            const containers = document.querySelectorAll('.tiles-container');
            containers.forEach(container => {
                container.addEventListener('dragover', handleContainerDragOver);
                container.addEventListener('dragleave', handleContainerDragLeave);
                container.addEventListener('drop', handleContainerDrop);
            });
        }

        function attachScheduleDragHandlers() {
            const tiles = document.querySelectorAll('.lesson-tile[draggable="true"]');
            tiles.forEach(tile => {
                tile.addEventListener('dragstart', handleTileDragStart);
                tile.addEventListener('dragend', handleDragEnd);
            });

            const cards = document.querySelectorAll('.lesson-card[draggable="true"]');
            cards.forEach(card => {
                card.addEventListener('dragstart', handleCardDragStart);
                card.addEventListener('dragend', handleDragEnd);
            });

            const slots = document.querySelectorAll('.lesson-slot');
            slots.forEach(slot => {
                slot.addEventListener('dragover', handleSlotDragOver);
                slot.addEventListener('dragleave', handleSlotDragLeave);
                slot.addEventListener('drop', handleSlotDrop);
            });

            // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ –ø–ª–∏—Ç–æ–∫
            const containers = document.querySelectorAll('.tiles-container');
            containers.forEach(container => {
                container.addEventListener('dragover', handleContainerDragOver);
                container.addEventListener('dragleave', handleContainerDragLeave);
                container.addEventListener('drop', handleContainerDrop);
            });
        }

        function handleTileDragStart(e) {
            draggedElement = e.target;
            draggedSubjectId = parseInt(e.target.dataset.subjectId);
            fromSchedule = false;
            
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', e.target.innerHTML);
        }

        function handleCardDragStart(e) {
            draggedElement = e.target;
            draggedSubjectId = parseInt(e.target.dataset.subjectId);
            fromSchedule = true;
            
            originalSlot = {
                classId: parseInt(e.target.dataset.classId),
                day: e.target.dataset.day,
                lesson: e.target.dataset.lesson
            };
            
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', e.target.innerHTML);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleSlotDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
            e.dataTransfer.dropEffect = 'move';
        }

        function handleSlotDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleSlotDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            const slot = e.currentTarget;
            const classId = parseInt(slot.dataset.classId);
            const day = slot.dataset.day;
            const lesson = slot.dataset.lesson;
            const key = `${day}-${lesson}`;
            
            const schedule = schedules[classId];
            
            // –Ø–∫—â–æ –ø–µ—Ä–µ–º—ñ—â—É—î–º–æ –∑ —Ä–æ–∑–∫–ª–∞–¥—É
            if (fromSchedule && originalSlot) {
                const oldKey = `${originalSlot.day}-${originalSlot.lesson}`;
                delete schedules[originalSlot.classId][oldKey];
            }
            
            // –î–æ–¥–∞—î–º–æ —É—Ä–æ–∫ –¥–æ –Ω–æ–≤–æ–≥–æ —Å–ª–æ—Ç—É
            const subject = subjects.find(s => s.id === draggedSubjectId);
            schedule[key] = {
                subjectId: subject.id,
                name: subject.name,
                teacher: subject.teacher
            };
            
            renderSchedules();
            renderSubjects();
        }

        function handleContainerDragOver(e) {
            if (fromSchedule) {
                e.preventDefault();
                e.currentTarget.classList.add('drag-over');
                e.dataTransfer.dropEffect = 'move';
            }
        }

        function handleContainerDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleContainerDrop(e) {
            if (!fromSchedule) return;
            
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            // –í–∏–¥–∞–ª—è—î–º–æ —É—Ä–æ–∫ –∑ —Ä–æ–∑–∫–ª–∞–¥—É
            if (originalSlot) {
                const oldKey = `${originalSlot.day}-${originalSlot.lesson}`;
                delete schedules[originalSlot.classId][oldKey];
            }
            
            renderSchedules();
            renderSubjects();
        }

        renderClasses();
    </script>
</body>
</html>
